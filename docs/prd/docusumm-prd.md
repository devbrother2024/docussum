# DocuSumm Product Requirements Document (PRD)

## 목표 및 배경 컨텍스트

### 목표

-   다양한 콘텐츠(텍스트, YouTube 영상)를 AI가 자동으로 요약해주는 고품질 유틸리티 SaaS 개발
-   글로벌 사용자를 타겟으로 한 해외 결제 시스템 및 이메일 자동화 구축
-   실제 수익화가 가능한 수준의 완성도 높은 서비스 구현

### 배경 컨텍스트

현대 사용자는 텍스트, PDF 문서, 영상 등 방대한 양의 정보에 노출되어 있으며, 이를 효율적으로 소비하고자 하는 니즈가 강함. DocuSumm은 AI 모델의 Long Context 강점을 활용하여 다양한 포맷의 자료를 빠르고 정확하게 요약해주는 서비스를 제공함으로써 생산성을 높이고자 함. 또한 글로벌 결제 및 알림 시스템을 통합하여 실제 운영 가능한 SaaS 모델을 검증하는 것을 목표로 함.

---

## 요구사항

### 기능 요구사항 (Functional Requirements)

#### 인증 (Authentication)

-   **FR001**: 사용자는 소셜 로그인(Google 등)을 통해 가입 및 로그인할 수 있어야 한다.
-   **FR002**: 로그인하지 않은 사용자는 서비스의 주요 기능(요약, 히스토리 등)에 접근할 수 없어야 한다 (Protected Routes).
-   **FR003**: 신규 가입 사용자에게는 **3 크레딧(요약 3회 분량)**의 무료 크레딧이 자동으로 지급되어야 한다.

#### 문서 관리 (Document Management)

-   **FR004**: 사용자는 자신의 과거 요약 요청 목록(History)을 날짜별로 조회할 수 있어야 한다.

#### AI 요약 (AI Summarization)

-   **FR005**: 사용자는 직접 텍스트를 입력하거나, YouTube 영상 URL을 입력하여 요약을 요청할 수 있어야 한다.
-   **FR006**: 시스템은 AI 모델을 활용하여 입력된 콘텐츠(긴 텍스트 포함)를 요약해야 한다.
-   **FR007**: 요약 요청 1회당 **1 크레딧**을 차감하며, 잔액 부족 시 요청을 거부해야 한다.
-   **FR008**: 요약 작업은 시간이 소요될 수 있으므로 백그라운드에서 비동기적으로 처리되어야 한다.

#### 이메일 자동화 (Email Automation)

-   **FR009**: 요약이 완료되면 시스템은 사용자에게 "요약 완료 알림" 이메일을 자동으로 발송해야 한다.
-   **FR010**: 이메일에는 요약 결과 페이지로 바로 이동할 수 있는 링크가 포함되어야 한다.

#### 해외 결제 (Global Payment)

-   **FR011**: 사용자는 글로벌 결제 서비스를 통해 **30 크레딧($5), 50 크레딧($8), 100 크레딧($15)** 단위 등 패키지로 크레딧을 충전할 수 있어야 한다.
-   **FR012**: 결제가 완료되면 해당 금액만큼의 크레딧이 사용자 계정에 즉시 충전되어야 한다.

### 비기능 요구사항 (Non-Functional Requirements)

-   **NFR001**: 사용자 데이터(요약본)는 철저히 격리되어 본인만 접근 가능해야 한다.
-   **NFR002**: 글로벌 결제 테스트를 위해 결제 서비스의 Test 모드와 Production 모드를 환경 변수로 분리하여 관리해야 한다.

---

## 사용자 여정 (User Journeys)

### 여정 1: 신규 사용자 요약 요청 및 결과 확인

1. 사용자가 메인 페이지(대시보드)에 접속하여 바로 텍스트를 입력하거나 YouTube URL을 붙여넣는다.
2. "요약하기" 버튼을 클릭한다.
3. (로그인하지 않은 경우) 로그인 모달이 뜨고 구글 소셜 로그인을 진행한다.
4. 로그인 완료 시 자동으로 요약 요청이 시작되며, 신규 가입 보너스 크레딧이 차감된다.
5. "요약이 시작되었습니다. 완료되면 이메일로 알려드립니다"라는 메시지를 확인한다.
6. 잠시 후, 가입한 이메일로 "DocuSumm: 요약이 완료되었습니다"라는 메일을 수신하고 결과를 확인한다.

### 여정 2: 크레딧 충전 (Pay-as-you-go)

1. 무료 크레딧을 모두 소진한 사용자가 추가 요약을 시도한다.
2. "크레딧이 부족합니다. 추가 크레딧을 충전하세요"라는 모달이 표시된다.
3. "충전하기" 버튼을 클릭하여 크레딧 구매 페이지로 이동한다.
4. 원하는 크레딧 패키지(예: 30회분 $5, 50회분 $8, 100회분 $15)를 선택하고 결제를 진행한다.
5. 결제 성공 후 크레딧이 즉시 충전되며, 중단되었던 요약 요청을 다시 진행한다.

---

## UX 디자인 원칙

### 핵심 원칙

-   **Simplicity (단순성)**: 별도의 시작 버튼 없이 메인 화면에서 즉시 입력이 가능해야 한다.
-   **Feedback (피드백)**: 비동기 작업의 특성상, 작업 시작/진행/완료 상태를 사용자에게 명확히 인지시켜야 한다.
-   **Focus (집중)**: 요약 결과 화면은 텍스트 가독성을 최우선으로 하여 불필요한 요소를 배제한다.
-   **Trust (신뢰)**: 결제 및 개인 문서 처리 과정에서 보안과 안전함을 시각적으로 전달해야 한다.

### 플랫폼 및 화면

-   **플랫폼**: 데스크톱 웹 (반응형 지원)
-   **핵심 화면**:
    -   대시보드 (메인 페이지, 입력 패널 통합)
    -   요약 상세 보기 (Markdown 렌더링)
    -   결제 및 설정 페이지

### 디자인 제약사항

-   AI 모델의 응답 시간에 따라 로딩 상태가 길어질 수 있음을 고려한 UI 설계 필요 (스켈레톤 UI 등)
-   유튜브 요약의 경우 썸네일 및 영상 메타데이터를 함께 표시하여 시각적 매력도 증대

---

## UI 디자인 목표

### 주요 UI 요소

1. **입력 패널 (Input Panel)**

    - 메인 화면 중앙에 위치 (Lading Page와 Dashboard 통합)
    - 탭 기반 인터페이스 (Text / YouTube)
    - URL 유효성 검사 및 실시간 피드백

2. **요약 결과 카드 (Summary Card)**

    - 핵심 내용 3줄 요약 (TL;DR) 섹션 강조
    - 마크다운 스타일링이 적용된 본문 텍스트
    - 복사하기, 공유하기 버튼 배치

3. **히스토리 리스트 (Sidebar History)**

    - 좌측 사이드바에 배치 (ChatGPT 스타일)
    - 날짜별 그룹핑 및 요약 제목 리스트
    - 클릭 시 우측 메인 영역에 해당 요약 결과 로드

### 인터랙션 패턴

-   사이드바 접기/펼치기 (Collapsible Sidebar)
-   긴 텍스트 입력 시 자동 높이 조절 (Auto-resize)
-   결제 진행 시 오버레이 모달 사용
-   토스트 메시지(Toast)를 활용한 상태 알림

---

## Epic 목록

### Epic 1: UI/UX 프레임워크 개발 (UI Only)

**목표**: 메인 대시보드, 사이드바, 입력 패널 등 핵심 화면의 퍼블리싱 및 반응형 UI 구현 (기능 제외)

-   [x] **Story 1.1: 프로젝트 기본 설정 및 레이아웃 구조 잡기**
    -   Next.js 16, Tailwind CSS, Shadcn UI 설치 및 초기화 완료
    -   좌측 사이드바 + 우측 메인 영역의 기본 레이아웃 구현 (`layout.tsx`)
    -   반응형 처리 (모바일에서 사이드바 동작)
-   [x] **Story 1.2: 입력 패널(Input Panel) UI 구현**
    -   Text/YouTube 탭 인터페이스 구현
    -   Textarea(자동 높이 조절) 및 Input 필드 배치
    -   URL 유효성 검사 UI (Visual Feedback)
-   [x] **Story 1.3: 요약 결과 카드 및 로딩 UI 구현**
    -   결과 로딩 시 스켈레톤(Skeleton) UI 표시
    -   결과 카드: TL;DR 섹션 + Markdown 본문 섹션
    -   복사/공유 액션 버튼 배치
-   [x] **Story 1.4: 사이드바 히스토리 및 상세 페이지 UI 구현** (추가됨)
    -   사이드바에 히스토리 목록 (Mock Data) 표시
    -   히스토리 클릭 시 상세 페이지 (`/dashboard/history/[id]`) 이동 구현
    -   클라이언트 사이드 네비게이션 최적화

### Epic 2: 핵심 기능 (Core Features) - 요약 엔진 및 결과 저장

**목표**: UI에 Gemini API를 연동하여 요약을 수행하고, 결과를 데이터베이스에 저장하는 전체 파이프라인 구축

-   [x] **Story 2.1: 데이터베이스 스키마 설계 및 ORM 설정**
    -   Supabase 연동 및 Drizzle ORM 설정 (`drizzle.config.ts`)
    -   `users`, `summaries` 테이블 스키마 정의 및 마이그레이션 완료
-   [x] **Story 2.2: Gemini API 연동 및 텍스트 요약 로직 구현**
    -   Google Gemini 2.0 Flash 모델 연동 (`lib/gemini`, `@google/genai`)
    -   프롬프트 엔지니어링 (3줄 요약 + 상세 요약 구조화, 한국어 출력)
    -   Server Action (`actions/summarize.ts`) 연결
-   [x] **Story 2.3: YouTube 영상 요약 로직 구현**
    -   YouTube URL 유효성 검증
    -   Gemini Multimodal 기능을 활용한 영상 요약 (URL 직접 처리)
-   [x] **Story 2.4: 요약 결과 저장 및 UI 연동**
    -   요약 완료 후 `summaries` 테이블에 결과 `INSERT`
    -   UI에 비동기 상태 반영 및 결과 카드 렌더링

### Epic 3: 인증 및 계정 관리 (히스토리)

**목표**: 사용자 식별(Supabase) 및 개인별 저장된 요약 히스토리 조회/관리 기능 구현

-   [x] **Story 3.1: 인증 환경 설정 및 로그인 UI 구현**
    -   Supabase SSR 패키지 설치 및 클라이언트 유틸리티 구성
    -   로그인 페이지 UI 및 Google OAuth 연동
    -   OAuth 콜백 처리 (`/auth/callback`) 구현
-   [x] **Story 3.2: 사용자 관리 및 무료 크레딧 지급**
    -   `public.users` 테이블 연동을 위한 Database Trigger 작성
    -   신규 가입 시 3 크레딧 자동 지급 로직 구현
-   [x] **Story 3.3: 보안 및 라우트 보호**
    -   Middleware 구현으로 비로그인 사용자 접근 제한 (`/dashboard`)
    -   세션 관리 및 리다이렉트 처리
-   [x] **Story 3.4: 개인화된 요약 및 히스토리 연동**
    -   요약 생성 시 실제 User ID 연결
    -   내 히스토리만 조회하는 RLS(Row Level Security) 또는 쿼리 필터링 적용
    -   히스토리 상세 페이지 권한 확인 로직 추가

### Epic 4: 결제 시스템 (수익화)

**목표**: 글로벌 결제 연동(Stripe) 및 크레딧 충전/차감 로직 구현

**예상 스토리 수**: 4

### Epic 5: 알림 및 이메일 서비스

**목표**: 요약 완료 이메일(Resend) 발송 및 전체적인 UX 폴리싱

**예상 스토리 수**: 2

---

## 범위 외 (Out of Scope)

### 현재 버전에서 제외되는 기능

-   **파일 업로드**: 초기 MVP에서는 텍스트 직접 입력과 URL 입력만 지원
-   **모바일 네이티브 앱**: 초기에는 반응형 웹에 집중
-   **실시간 영상 자막 추출**: AI 모델이 처리 가능한 범위 내에서만 영상 요약 지원 (별도 STT 엔진 미사용)
-   **커뮤니티 기능**: 다른 사용자의 요약을 보거나 공유하는 소셜 기능 제외
-   **Hwp/Docx 파일 파싱**: 파일 업로드 기능 제외로 인해 불필요

### 지원하지 않는 플랫폼

-   Internet Explorer 등 레거시 브라우저

### 기술적 제약

-   AI 모델의 토큰 제한(Context Window)을 초과하는 초대용량 텍스트는 지원 불가할 수 있음
-   비공개 YouTube 영상은 요약 불가
